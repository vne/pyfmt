/*! pyfmt 0.0.1 // 23.04.2014 // Vladimir Neverov <sanguini@gmail.com> // https://github.com/vne/pyfmt/wiki */
!function(){function a(a,b){this.string=a,this.options=b,this.space_char=b&&"undefined"!=typeof b.space?b.space:" ",b&&b.nbsp&&(this.space_char="&nbsp;")}var b,c=["d","i","o","u","x","X","e","E","f","F","g","G","c","r","s","%"],d=["d","i","o","u","x","X","e","E","f","F","g","G"],e=["d","i","u"],f=/[1-9\.]/,g=/[0-9\.]/,h=/[#0\- \+]/,i={"#":"alt",0:"zero","-":"left"," ":"space","+":"sign"},j={COPY:0,PERCENT:1,NAME:2,FORMAT:3};try{b=window.JSON}catch(k){try{b=require("JSON")}catch(l){}}a.upgrade=function(){return String.prototype.pyfmt=function(){var b=this.toString();if(!arguments.length)return this;var c=new a(b);return c.format.apply(c,arguments)},this},a.prototype.format=function(a){return this.parse(a.constructor===Object||a.constructor===Array?a:Array.prototype.slice.call(arguments,0))},a.prototype.parse=function(a){var b,d,e=this.string.length,k=j.COPY,l=0,m="",n={},o=0;if(!a||!a.constructor)return"";for(this.is_obj=a.constructor===Object?!0:!1,this.data=a,b=0;e>b;b++)if(d=this.string.charAt(b),k===j.COPY)l||"%"!==d?m+=d:"%"===d&&(k=j.PERCENT);else if(k===j.PERCENT)if("("===d)k=j.NAME;else if(c.indexOf(d)>=0)n.argcnt=o++,n.format=d,m+=this.format_arg(n,a),n={},k=j.COPY;else if(!n.mod&&f.test(d))n.mod=d;else if(n.mod&&g.test(d))n.mod+=d;else{if(!h.test(d))throw"pyformat: bad format specifier: "+d;if(n.mod)throw"pyformat: width modifier should go after flags";n[i[d]]=!0}else if(k===j.NAME)")"!==d?n.name?n.name+=d:n.name=d:k=j.FORMAT;else if(k===j.FORMAT)if(c.indexOf(d)>=0)n.format=d,m+=this.format_arg(n,a),n={},k=j.COPY;else if(!n.mod&&f.test(d))n.mod=d;else if(n.mod&&g.test(d))n.mod+=d;else{if(!h.test(d))throw"pyformat: bad format specifier: "+d;if(n.mod)throw"pyformat: width modifier should go after flags";n[i[d]]=!0}return m+=this.format_arg(n,a)},a.prototype.resolve=function(a,b){if(a.indexOf(".")<=0)return"";var c,d=a.split("."),e=b;for(c in d){if("undefined"==typeof e[d[c]])return"";e=e[d[c]]}return e},a.prototype.format_arg=function(a,c){var f,g,h,i,j,k="",l=!1,m=10;if(!a)return"";if(0===Object.keys(a).length)return k;if(this.is_obj&&!a.name)throw"pyformat: object is passed as argument to a array-based formatting string";if(a.mod&&(h=a.mod.split("."),f=parseInt(h[0],10),2===h.length&&(g=parseInt(h[1],10))),this.is_obj)if("undefined"!=typeof c[a.name])k=c[a.name];else{if(!(a.name.indexOf(".")>=0))throw"pyformat: key "+a.name+" does not exist in the object";k=this.resolve(a.name,c)}else k=c[a.argcnt];if(d.indexOf(a.format)>=0)l=!0,e.indexOf(a.format)>=0?(k=parseInt(k,10),g&&g>0&&(k=k.toFixed(g))):["e","E","g","G"].indexOf(a.format)>=0?(k=parseFloat(k,10).toExponential(),!g&&a.alt&&(k=k.toString(),h=k.indexOf("e"),k=k.substr(0,h)+"."+k.substr(h))):["f","F"].indexOf(a.format)>=0?(k=parseFloat(k,10),g&&g>0?k=k.toFixed(g):!g&&a.alt&&(k=k.toString()+".")):"o"===a.format?(m=8,k=Number(k).toString(8),a.alt&&0!==k&&(k="0"+k.toString())):["x","X"].indexOf(a.format)>=0&&(m=16,k=Number(k),isNaN(k)?k=0:(k=k.toString(16),a.alt&&0!==k&&(k="0x"+k))),["x","e","f","g"].indexOf(a.format)>=0?k=k.toString().toLowerCase():["X","E","F","G"].indexOf(a.format)>=0&&(k=k.toString().toUpperCase()),["x","X"].indexOf(a.format)<0&&isNaN(k)&&(k=0);else if("c"===a.format)k=k&&k.constructor&&k.constructor===String?k.charAt(0):isNaN(Number(k))?"":String.fromCharCode(k);else if("r"===a.format){if(!b)throw"No JSON library is available, couldn't use the %r format specifier. Please, install JSON.js or use a modern browser";k=b.stringify(k),g&&(k=k.substr(0,g))}else"s"===a.format&&(k=k.toString(),g&&(k=k.substr(0,g)));if(k=l?a.sign&&parseInt(k,m)>=0?"+"+k.toString():a.space&&parseInt(k,m)>=0?" "+k.toString():k.toString():k.toString(),f&&f>0&&k.length<f)if(j=a.zero?"0":this.space_char,h=f-k.length,a.left)for(i=0;h>i;i++)k+=j;else for(i=0;h>i;i++)k=j+k;return k.toString()};try{module.exports=a}catch(k){window.pyfmt=a}}();
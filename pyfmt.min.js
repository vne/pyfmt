/*! pyfmt 0.0.1 // 22.04.2014 // Vladimir Neverov <sanguini@gmail.com> // https://github.com/vne/pyfmt/wiki */
!function(){function a(a,b){this.string=a,this.options=b,this.space_char=b&&"undefined"!=typeof b.space?b.space:" ",b&&b.nbsp&&(this.space_char="&nbsp;")}var b,c=["d","i","o","u","x","X","e","E","f","F","g","G","c","r","s","%"],d=["d","i","o","u","x","X","e","E","f","F","g","G"],e=["d","i","u"],f=/[0-9\.]/,g={COPY:0,PERCENT:1,NAME:2,FORMAT:3};try{b=window.JSON}catch(h){try{b=require("JSON")}catch(i){}}a.upgrade=function(){return String.prototype.pyfmt=function(){var b=this.toString();if(!arguments.length)return this;var c=new a(b);return c.format.apply(c,arguments)},this},a.prototype.format=function(a){return this.parse(a.constructor===Object||a.constructor===Array?a:Array.prototype.slice.call(arguments,0))},a.prototype.parse=function(a){var b,d,e=this.string.length,h=g.COPY,i=0,j="",k={},l=0;if(!a||!a.constructor)return"";for(this.is_obj=a.constructor===Object?!0:!1,this.data=a,b=0;e>b;b++)if(d=this.string.charAt(b),h===g.COPY)i||"%"!==d?j+=d:"%"===d&&(h=g.PERCENT);else if(h===g.PERCENT)if("("===d)h=g.NAME;else if(c.indexOf(d)>=0)k.argcnt=l++,k.format=d,j+=this.format_arg(k,a),k={},h=g.COPY;else{if(!f.test(d))throw"pyformat: bad format specifier: "+d;k.mod?k.mod+=d:k.mod=d}else if(h===g.NAME)")"!==d?k.name?k.name+=d:k.name=d:h=g.FORMAT;else if(h===g.FORMAT)if(c.indexOf(d)>=0)k.format=d,j+=this.format_arg(k,a),k={},h=g.COPY;else{if(!f.test(d))throw"pyformat: bad format specifier: "+d;k.mod?k.mod+=d:k.mod=d}return j+=this.format_arg(k,a)},a.prototype.resolve=function(a,b){if(a.indexOf(".")<=0)return"";var c,d=a.split("."),e=b;for(c in d){if("undefined"==typeof e[d[c]])return"";e=e[d[c]]}return e},a.prototype.format_arg=function(a,c){var f,g,h,i,j="";if(!a)return"";if(0===Object.keys(a).length)return j;if(this.is_obj&&!a.name)throw"pyformat: object is passed as argument to a array-based formatting string";if(a.mod&&(h=a.mod.split("."),f=parseInt(h[0],10),2===h.length&&(g=parseInt(h[1],10))),this.is_obj)if("undefined"!=typeof c[a.name])j=c[a.name];else{if(!(a.name.indexOf(".")>=0))throw"pyformat: key "+a.name+" does not exist in the object";j=this.resolve(a.name,c)}else j=c[a.argcnt];if(d.indexOf(a.format)>=0)e.indexOf(a.format)>=0?(j=parseInt(j,10),g&&g>0&&(j=j.toFixed(g))):["e","E","g","G"].indexOf(a.format)>=0?j=parseFloat(j,10).toExponential():["f","F"].indexOf(a.format)>=0?(j=parseFloat(j,10),g&&g>0&&(j=j.toFixed(g))):"o"===a.format?j=Number(j).toString(8):["x","X"].indexOf(a.format)>=0&&(j=Number(j).toString(16)),["x","e","f","g"].indexOf(a.format)>=0?j=j.toString().toLowerCase():["X","E","F","G"].indexOf(a.format)>=0&&(j=j.toString().toUpperCase()),isNaN(j)&&(j=0);else if("c"===a.format)j=j&&j.constructor&&j.constructor===String?j.charAt(0):isNaN(Number(j))?"":String.fromCharCode(j);else if("r"===a.format){if(!b)throw"No JSON library is available, couldn't use the %r format specifier. Please, install JSON.js or use a modern browser";j=b.stringify(j,void 0,0)}else"s"===a.format&&(j=j.toString());if(j=j.toString(),f&&f>0&&j.length<f)for(h=f-j.length,i=0;h>i;i++)j=this.space_char+j;return j.toString()};try{module.exports=a}catch(h){window.pyfmt=a}}();